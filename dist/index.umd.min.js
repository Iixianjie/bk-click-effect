!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).BkEffect=t()}(this,function(){"use strict";!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(".bk-effect {\n  position: relative;\n  overflow: hidden;\n}\n\n.bk-effect.__light .bk-effect-ripple{\n  background: rgba(255,255,255,0.3);\n}\n\n.bk-effect.__red .bk-effect-ripple{\n  background: rgba(245, 34, 45, 0.4);\n}\n\n.bk-effect.__orange .bk-effect-ripple{\n  background: rgba(250, 140, 22, 0.4);\n}\n\n.bk-effect.__yellow .bk-effect-ripple{\n  background: rgba(250, 219, 20, 0.4);\n}\n\n.bk-effect.__green .bk-effect-ripple{\n  background: rgba(82, 196, 26, 0.4);\n}\n\n.bk-effect.__cyan .bk-effect-ripple{\n  background: rgba(19, 194, 194, 0.4);\n}\n\n.bk-effect.__blue .bk-effect-ripple{\n  background: rgba(24, 144, 255, 0.4);\n}\n\n.bk-effect.__purple .bk-effect-ripple{\n  background: rgba(114, 46, 209, 0.4);\n}\n\n.bk-effect-ripple {\n  position: absolute;\n  border-radius: 50%;\n  width: 0;\n  height: 0;\n  opacity: 1;\n  background: rgba(0,0,0,0.16);\n  transition: 0.7s ease-out;\n  transition-property: transform, opacity;\n  transform: scale(0.1);\n  pointer-events: none;\n}");var e=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};var t=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}};var n=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)};var i=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var r=function(e){return t(e)||n(e)||i()};var o=function(e){if(Array.isArray(e))return e};var a=function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n};var s=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var c=function(e,t){return o(e)||a(e,t)||s()};var l=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function u(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e};function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}var p={effect:"bk-effect",disabled:"__disabled",disabledwinStyle:"__disabledWinStyle",disabledMdStyle:"__disabledMdStyle"},v=function(){function t(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,t),this.triggerEl=null,this.supportTouch="ontouchstart"in window,this.ripple=null,this.onDown=function(e){var t=n.getCrrentEl(e);if(t){var i=n.isEffectEl(t),r=n.isDisabledWinStyle(t),o=n.isDisabledMdStyle(t),a=n.isDisabled(t);if(i){if(a)return;n.triggerEl=t,r||(n.onMove(e,!0),n.bindMoveEvent()),o||(n.ripple=n.displayRipple(t,e))}}},this.onUp=function(){n.unbindMoveEvent(),n.ripple&&(n.ripple.setAttribute("data-hold",2),n.romoveRipple(n.ripple),n.ripple=null)},this.onMove=function(e,t){if(!n.stopFlag){n.stopFlag=!0,setTimeout(function(){n.stopFlag=!1},100);var i=n.supportTouch?e.changedTouches[0]:e,o=n.triggerEl.getBoundingClientRect(),a=n.inArea(i,o);if(a||n.unbindMoveEvent(),a){var s=n.getOffestPos(i,o),l=c(s,2),u=n.getRotateRatio(o.width,o.height,l[0],l[1]);n.setRotate.apply(n,r(u))}}},this.inArea=function(e,t){return!(t.x>e.clientX||t.y>e.clientY||e.clientX>t.x+t.width||e.clientY>t.y+t.height)},t.loaded||(t.loaded=!0,this.option=function(t){for(var n=1;arguments.length>n;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?d(i,!0).forEach(function(n){e(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({},p,{},i),this.init())}return f(t,[{key:"init",value:function(){this.bindUpEvent(),this.bindDownEvent()}},{key:"displayRipple",value:function(e,t){var n=this,i=this.supportTouch?t.changedTouches[0]:t,r=e.getBoundingClientRect(),o=document.createElement("div"),a=this.getOffestPos(i,r),s=c(a,2),l=s[0],u=s[1],f=Math.max(1.8*r.width,1.8*r.height);return o.className="bk-effect-ripple",o.style.left="".concat(l-f/2,"px"),o.style.top="".concat(u-f/2,"px"),o.style.height="".concat(f,"px"),o.style.width="".concat(f,"px"),o.setAttribute("data-hold",1),e.appendChild(o),setTimeout(function(){o.style.transform="scale3d(1, 1, 1)",o.style.opacity=0,n.romoveRipple(o)}),o}},{key:"romoveRipple",value:function(e){var t=this;if(1===+e.getAttribute("data-hold"))return e.style.opacity=1,void setTimeout(function(){t.romoveRipple(e)},700);setTimeout(function(){e.style.opacity=0,e.style.transition="all 0.3s ease-out",setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},300)},300)}},{key:"getOffestPos",value:function(e,t){return[e.clientX-t.x,e.clientY-t.y]}},{key:"getRotateRatio",value:function(e,t,n,i){var r=this.calcRotateRatio(n/e),o=this.calcRotateRatio(i/t,!0);return[r,o,0===r&&0===o?.9:1]}},{key:"calcRotateRatio",value:function(e,t){return e>.3?.7>=e&&e>.3?0:t?-1:1:t?1:-1}},{key:"setRotate",value:function(e,t,n){this.triggerEl.style.transition="70ms ease-in-out",this.triggerEl.style.transformOrigin="50% 50%",this.triggerEl.style.transform="perspective(400px) rotate3d(".concat(t,", ").concat(e,", 0, 16deg) scale3d(").concat(n,", ").concat(n,", 1)")}},{key:"removeRotate",value:function(){var e=this;this.triggerEl&&(this.triggerEl.style.transformOrigin="",this.triggerEl.style.transform="",setTimeout(function(){e.triggerEl.style.transition=""},70))}},{key:"bindUpEvent",value:function(){this.supportTouch?(document.addEventListener("touchend",this.onUp,!1),document.addEventListener("touchcancel",this.onUp,!1)):(document.addEventListener("mouseup",this.onUp,!1),document.addEventListener("mouseleave",this.onUp,!1),document.addEventListener("dragend",this.onUp,!1))}},{key:"bindDownEvent",value:function(){this.supportTouch?document.addEventListener("touchstart",this.onDown,!1):document.addEventListener("mousedown",this.onDown,!1)}},{key:"bindMoveEvent",value:function(){this.supportTouch?document.addEventListener("touchmove",this.onMove,{passive:!1}):document.addEventListener("mousemove",this.onMove,!1)}},{key:"unbindMoveEvent",value:function(){this.removeRotate(),this.supportTouch?document.removeEventListener("touchmove",this.onMove):document.removeEventListener("mousemove",this.onMove)}},{key:"getCrrentEl",value:function(e){return this.getWavesEffectElement(e)}},{key:"isEffectEl",value:function(e){return-1!==e.className.indexOf(this.option.effect)}},{key:"isDisabledWinStyle",value:function(e){return-1!==e.className.indexOf(this.option.disabledwinStyle)}},{key:"isDisabledMdStyle",value:function(e){return-1!==e.className.indexOf(this.option.disabledMdStyle)}},{key:"isDisabled",value:function(e){return RegExp(this.option.disabled+"(\\s|)$").test(e.className)}},{key:"getWavesEffectElement",value:function(e){for(var t=null,n=e.target||e.srcElement;null!==n.parentNode;){if(!(n instanceof SVGElement)&&-1!==n.className.indexOf(this.option.effect)){t=n;break}n=n.parentNode}return t}}]),t}();return v.loaded=!1,v});
